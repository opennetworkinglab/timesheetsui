<!--
~ Copyright 2020-present Open Networking Foundation
~
~ Licensed under the Apache License, Version 2.0 (the "License");
~ you may not use this file except in compliance with the License.
~ You may obtain a copy of the License at
~
~     http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS,
~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
~ See the License for the specific language governing permissions and
~ limitations under the License.
-->

<div>

    <div class="mat-typography">

        <div class="center custom-theme font-size-weekchooser" style="padding-top: 50px; padding-left: 20px; padding-right: 20px">
            <button mat-mini-fab (click)="changeWeek(-1); changeWeekAlreadySigned(-1)" class="btn btn-outline-primary" color="accent"><mat-icon>chevron_left</mat-icon></button>
            Week: {{currentWeekId}} || {{weeks.get(currentWeekId)?.begin | date: 'MMM d, y':'UTC'}}
                - {{weeks.get(currentWeekId)?.end | date: 'MMM d, y':'UTC'}}
            <button mat-mini-fab (click)="changeWeek(1); changeWeekAlreadySigned(1)" class="btn btn-outline-primary" color="accent"><mat-icon>chevron_right</mat-icon></button>
        </div>

        <div class="img-container" style="margin-top: 50px" id="signed" *ngIf="showPreview">
            <img class="responsive" src="{{weekly.preview}}">
        </div>

        <div class="center" *ngIf="!showPreview">
            <h3 class="mat-h2">Please choose hours in decimal format</h3>
        </div>

        <div class="center-table" *ngIf="!showPreview">

            <div class="cdk-overlay-pane center" *ngIf="loadingProgress">
                <mat-spinner></mat-spinner>
            </div>

            <table class="table table-responsive">
                <tbody>
                <tr>
                    <td style="min-width: 180px; cursor: default">
                        <table>
                            <thead>
                            <th>Day - Date</th>
                            </thead>
                            <tbody>
                            <tr title="DARPA Project">DARPA HR001120C0107 ({{darpaAllocationPct}}%)</tr>
                            <tr title="Internal Research and Development">IR&D</tr>
                            <tr title="General and Administrative">G&A</tr>
                            <tr title="Paid time off">PTO</tr>
                            <tr title="Medical Leave">Sick</tr>
                            <tr title="US Public Holiday or ONF Day Off">ONF Holiday</tr>
                        </table>
                    </td>
                    <td *ngFor="let d of days | keyvalue">
                        <app-day [day]="d.key | date: 'EEE dd':'UTC'" [email]="d.value.email"
                                 [onfDay]="isOnfDay(d.key, currentWeekId)"
                                 [times]="d.value.times" [userSigned]="userSigned"
                                 [weekend]="isWeekend(d.key)" (projectTimeChange)="projectTimeChange($event)"
                                 [dayId]="d.key">
                        </app-day>
                    </td>
                    <td>
                        <table>
                            <thead>
                            <th>Weekly Totals</th>
                            </thead>
                            <tbody>
                            <tr [ngClass]="darpaWarn?'pad-warn':''">{{darpaMins}}</tr>
                            <tr>{{iRDMins}}</tr>
                            <tr>{{gAMins}}</tr>
                            <tr>{{ptoMins}}</tr>
                            <tr>{{sickMins}}</tr>
                            <tr>{{holidayMins}}</tr>
                            <tr [ngClass]="darpaWarn?'pad-warn':'total'">{{totalMins}}</tr>
                        </table>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div *ngIf="!showPreview" class="custom-theme center" style="padding-top: 60px">
            <button (click)="sign()" [disabled]="signBtnDisabled" color="accent" class="font-size-btn"
                    mat-raised-button>{{signBtnName}}</button><mat-icon color="primary" matTooltip="Upon completing your weekly timesheet, press the button below to submit it to DocuSign for your signature.  You will be directed to DocuSign, please sign your timesheet there" matTooltipPosition="right">info</mat-icon>
        </div>
    </div>
</div>

